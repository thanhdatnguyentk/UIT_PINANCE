<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>L·ªánh ƒëang ch·ªù kh·ªõp</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}"/>
</head>
<body>
    <div class="app">
        <aside class="sidebar">
          <div class="logo">UIT Pinance</div>
          <nav>
            <a href="{{ url_for('dashboard') }}" >Dashboard</a>
            <a href="{{ url_for('watchlist') }}">Watchlist</a>
            <a href="{{ url_for('markets')}}">Markets</a>
            <a href="{{ url_for('pending_orders')}}" class="active">Orders</a>     

  <a href="{{ url_for('help_page')}}">Help</a>       
          </nav>
        </aside>

  <div class="main-content">
     <header class="topbar">
        <div class="breadcrumbs">Orders</div>
        <div class="topbar-search">
          <!-- Unified search: t√¨m theo ticker ho·∫∑c t√™n c√¥ng ty -->
          <form action="{{ url_for('company_search') }}" method="get" class="search-form">
            <input
              type="text"
              name="query"
              class="search-input"
              placeholder="Nh·∫≠p m√£ ho·∫∑c t√™n c√¥ng ty..."
              required
            />
           <button type="submit" class="search-button">üîç</button>
          </form>
        </div>

        <div class="topbar-right">
          <div class="profile-menu">
            <img
              src="{{ url_for('static', filename='images/avatar.png') }}"
              alt="Avatar"
              class="avatar"
              onclick="toggleProfileDropdown()"
            />
            <div id="profileDropdown" class="dropdown-content">
              <div class="user-info">
                <img
                  src="{{ url_for('static', filename='images/avatar.png') }}"
                  alt="Avatar"
                  class="avatar-lg"
                />
                <div>
                  <p class="name">
                    {{ user.first_name }} {{ user.last_name }}
                  </p>
                  <p class="email">{{ user_email }}</p>
                </div>
              </div>
    
              <a href="{{ url_for('edit_profile') }}">Ch·ªânh s·ª≠a h·ªì s∆°</a>
              <a href="{{ url_for('transactions') }}">L·ªãch s·ª≠ giao d·ªãch</a>
              <a href="{{ url_for('deposit') }}">N·∫°p ti·ªÅn</a>
              <a href="{{ url_for('withdraw') }}">R√∫t ti·ªÅn</a>
              <a href="{{ url_for('logout') }}">ƒêƒÉng xu·∫•t</a>
            </div>
          </div>
        </div>
      </header>

    <section class="accounts-table">
      <h2>S·ªï l·ªánh</h2>
      <table>
        <thead>
          <tr>
            <th>M√£ l·ªánh</th>
            <th>C·ªï phi·∫øu</th>
            <th>Lo·∫°i</th>
            <th>S·ªë l∆∞·ª£ng</th>
            <th>Gi√°</th>
            <th>Th·ªùi gian ƒë·∫∑t</th>
            <th>Tr·∫°ng th√°i</th>
          </tr>
        </thead>
        <tbody>
          {% for o in orders  %}
          <tr>
            <td>{{ o.order_id }}</td>
            <td>{{ o.ticker_symbol }}</td>
            <td>{{ o.order_type }}</td>
            <td>{{ o.quantity }}</td>
            <td>{{ "{:,.0f}".format(o.price) }}$</td>
            <td>{{ o.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</td>
            <td>{{ o.status }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </section>
  </div>

  <script>
    function toggleProfileDropdown() {
      document.getElementById('profileDropdown').classList.toggle('show');
    }
    window.onclick = function(event) {
      if (!event.target.matches('.avatar')) {
        document.querySelectorAll('.dropdown-content.show').forEach(el=>el.classList.remove('show'));
      }
    };
  </script>
</body>
</html>
